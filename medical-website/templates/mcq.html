{% extends 'index.html' %}

{% block title %}Chat with the Doctor{% endblock %}

{% block morecss %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/chat.css') }}">
{% endblock %}

{% block content %}
<section class="masthead text-center">
    <div class="container">
        <h1>Chat with the Doctor</h1>
        <form action="{{ url_for('chat_message') }}" method="POST">
            <div class="form-group">
                {% if not drname %}
                <input type="text" id="drname" name="drname" class="form-control" placeholder="Enter doctor's username...">
                {% else %}
                <input type="text" id="drname" name="drname" class="form-control" value="{{ drname }}" readonly>
                {% endif %}
            </div>
            <div class="row justify-content-center">
                <div class="col-md-8 mx-auto">
                    <div class="chat-container" id="chatcontainer">
                        <div id="chat" class="mb-3">
                            {% for message in chat_history %}
                            <div class="{{ 'user-message' if message.sender_type == 'user' else 'server-message' }}">
                                {{ message.content }}
                            </div>
                            {% endfor %}
                        </div>
                    </div>                           
                </div>
            </div>
            <div class="form-group">
                <textarea name="message" id="messageInput" class="form-control" placeholder="Type a message..."></textarea>
            </div>
            {% if not drname %}
            <button type="submit" name="chooseBtn" class="btn btn-success">Choose</button>
            {%else%}
            <button type="submit" class="btn btn-primary">Send</button>
            {% endif %}
        </form>
    </div>
</section>
{% endblock %}


{% block morejs %}
<script src="{{ url_for('static', filename='js/chat.js') }}"></script>
{%endblock%}
